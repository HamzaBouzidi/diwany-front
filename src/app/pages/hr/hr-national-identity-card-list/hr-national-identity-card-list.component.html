<div class="search-container">
 <input type="text" [(ngModel)]="searchTerm" placeholder="ุงุจุญุซ ุนู ุงููุณุชุฎุฏู" class="search-input" dir="rtl" />
</div>
<!-- Notifications -->
<div *ngIf="notifications.length" class="notification-container">
 <div *ngFor="let notification of notifications; let i = index" class="notification-popup">
  {{ notification }}
  <button class="close-btn" (click)="closeNotification(i)">ร</button>
 </div>
</div>
<div *ngIf="isLoading" class="spinner">Loading...</div>
<div *ngIf="errorMessage" class="error-message">{{ errorMessage }}</div>

<div *ngIf="!isLoading && !errorMessage">
 <div class="table-container">
  <h2>ูุงุฆูุฉ ุจุทุงูุงุช ุงูุชุนุฑูู</h2>
  <table class="cin-table" dir="rtl">
   <thead>
    <tr>
     <th>ุงุณู ุงููุณุชุฎุฏู</th>
     <th>ุงูุฑูู ุงููุทูู</th>
     <th>ุงูุตูุฉ</th>
     <th>ุงูุญุงูุฉ</th>
    </tr>
   </thead>
   <tbody>
    <tr *ngFor="let cin of filteredCins.slice().reverse()" (click)="openModal(cin)" class="clickable-row"
     [ngClass]="{ 'highlight-pending': cin.isPending }">
     <td>{{ cin.user_name }}</td>
     <td>{{ cin.user_natio_num }}</td>
     <td>{{ cin.user_sifa }}</td>
     <td>
      <span *ngIf="cin.state === 'Approved'" class="status accepted">โ๏ธ ููุจููุฉ</span>
      <span *ngIf="cin.state === 'Rejected'" class="status rejected">โ ูุฑููุถุฉ</span>
      <span *ngIf="cin.state === 'Pending'" class="status pending">๐ ููุฏ ุงูุชูููุฐ</span>
     </td>
     
    </tr>
    <tr *ngIf="filteredCins.length === 0">
     <td colspan="4" class="empty-message">ูุง ุชูุฌุฏ ุจูุงูุงุช ูุนุฑุถูุง.</td>
    </tr>
   </tbody>
  </table>
 </div>
</div>

<!-- Modal for CIN Details -->
<div *ngIf="isModalVisible" class="modal">
 <div class="modal-content">
  <!-- Close button (X) -->
  <button class="close-btn" (click)="closeModal()">ร</button>

  <h3>ุชูุงุตูู ุงูุทูุจ</h3>
  <p><strong>ุงุณู ุงููุณุชุฎุฏู:</strong> {{ selectedCin?.user_name }}</p>
  <p><strong>ุฑูู ุงูุจุทุงูุฉ:</strong> {{ selectedCin?.user_num }}</p>
  <p><strong>ุงูุฑูู ุงููุทูู:</strong> {{ selectedCin?.user_natio_num }}</p>
  <p><strong>ุงูุตูุฉ:</strong> {{ selectedCin?.user_sifa }}</p>
  <p><strong>ุงูุญุงูุฉ ุงูุญุงููุฉ:</strong>
   <span *ngIf="selectedCin?.state === 'Approved'" class="status accepted">โ๏ธ ููุจููุฉ</span>
   <span *ngIf="selectedCin?.state === 'Rejected'" class="status rejected">โ ูุฑููุถุฉ</span>
   <span *ngIf="selectedCin?.state === 'Pending'" class="status pending">๐ ููุฏ ุงูุชูููุฐ</span>
  </p>

  <!-- Show buttons only if the state is 'Pending' -->
  <div class="button-group" *ngIf="selectedCin?.state === 'Pending'">
   <button class="approve-btn" (click)="updateCinState('Approved')">ููุงููุฉ</button>
   <button class="reject-btn" (click)="updateCinState('Rejected')">ุฑูุถ</button>
  </div>
  </div>
  </div>