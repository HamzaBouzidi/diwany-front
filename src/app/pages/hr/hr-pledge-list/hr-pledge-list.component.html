<div class="search-container">
<input type="text" [(ngModel)]="searchTerm" (input)="filterPledges()" placeholder="ุงุจุญุซ ุนู ุงูููุธู" class="search-input"
   dir="rtl" />
</div>
<!-- Notifications -->
<div *ngIf="notifications.length" class="notification-container">
 <div *ngFor="let notification of notifications; let i = index" class="notification-popup">
  {{ notification }}
  <button class="close-btn" (click)="closeNotification(i)">ร</button>
 </div>
</div>
<div *ngIf="isLoading" class="spinner">ุฌุงุฑู ุงูุชุญููู...</div>
<div *ngIf="errorMessage" class="error-message">{{ errorMessage }}</div>

<div *ngIf="!isLoading && !errorMessage">
 <div class="table-container">
  <h2>ูุงุฆูุฉ ุงูุฅูุฑุงุฑุงุช</h2>
  <table class="pledge-table" dir="rtl">
   <thead>
    <tr>
     <th>ุงุณู ุงูููุธู</th>
      <th> ุงูุฑูู ุงููุธููู</th>
     <th>ุงููุคูู ุงูุนููู</th>
     <th>ุงูุญุงูุฉ</th>
    </tr>
   </thead>
   <tbody>
    <!-- 
                    <tr *ngFor="let pledge of filteredPledges.slice().reverse()" (click)="openModal(pledge)" class="clickable-row"
                 [ngClass]="{ 'new-request': pledge.isNew }">
                -->
    <tr *ngFor="let pledge of filteredPledges.slice().reverse()" (click)="openModal(pledge)" class="clickable-row"
     [ngClass]="{ 'highlight-pending': pledge.isPending }">

     <td>{{ pledge.employeeName }}</td>
     <td>{{ pledge.employee_rw }}</td>
     <td>{{ pledge.employeeDegree }}</td>
     <td>
      <span *ngIf="pledge.state === 'approved'" class="status accepted">โ๏ธ ููุจููุฉ</span>
      <span *ngIf="pledge.state === 'rejected'" class="status rejected">โ ูุฑููุถุฉ</span>
      <span *ngIf="pledge.state === 'pending'" class="status pending">๐ ููุฏ ุงูุชูููุฐ</span>
     </td>
    </tr>
    <tr *ngIf="filteredPledges.length === 0">
     <td colspan="4" class="empty-message">ูุง ุชูุฌุฏ ุจูุงูุงุช ูุนุฑุถูุง.</td>
    </tr>
   </tbody>
  </table>
 </div>
</div>

<!-- Modal for Pledge Details -->
<div *ngIf="isModalVisible" class="modal">
 <div class="modal-content">
  <button class="close-btn" (click)="closeModal()">ร</button>
  <h3>ุชูุงุตูู ุงูุฅูุฑุงุฑ</h3>
  <p><strong>ุงุณู ุงูููุธู:</strong> {{ selectedPledge?.employeeName }}</p>
  <p><strong>ุงูุฑูู ุงููุทูู:</strong> {{ selectedPledge?.employee_rw }}</p>
  <p><strong>ุงููุคูู ุงูุนููู:</strong> {{ selectedPledge?.employeeDegree }}</p>
  <p><strong>ุงูุญุงูุฉ ุงูุญุงููุฉ:</strong>
   <span *ngIf="selectedPledge?.state === 'approved'" class="status accepted">โ๏ธ ููุจููุฉ</span>
   <span *ngIf="selectedPledge?.state === 'rejected'" class="status rejected">โ ูุฑููุถุฉ</span>
   <span *ngIf="selectedPledge?.state === 'pending'" class="status pending">๐ ููุฏ ุงูุชูููุฐ</span>
  </p>
  <div *ngIf="selectedPledge?.documentLink" class="document-links">
   <h4>ุฑุงุจุท ุงููุซููุฉ:</h4>
   <button (click)="openDocument(selectedPledge.documentLink)">ุนุฑุถ ุงููุซููุฉ</button>
  </div>
  <div class="button-group" *ngIf="selectedPledge?.state === 'pending'">
   <button class="approve-btn" (click)="updatePledgeState('approved')">ููุงููุฉ</button>
   <button class="reject-btn" (click)="updatePledgeState('rejected')">ุฑูุถ</button>
  </div>
 </div>
</div>