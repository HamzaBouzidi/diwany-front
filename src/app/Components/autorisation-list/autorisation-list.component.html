<div class="search-container">
  <input type="text" [(ngModel)]="searchTerm" placeholder="ุงุจุญุซ ุนู ุงูููุธู ุฃู ููุน ุงูุฅุฐู" class="search-input" dir="rtl" />
  <i class="fas fa-search search-icon"></i>
</div>

<div *ngIf="notifications.length" class="notification-container">
  <div *ngFor="let notification of notifications; let i = index" class="notification-popup">
    {{ notification }}
    <button class="close-btn" (click)="closeNotification(i)">ร</button>
  </div>
</div>

<div class="toggle-buttons">
  <button class="toggle-button" (click)="toggleTable('myExits')" [class.active]="showMyExits">
    ุฃุฐููุงุชู
  </button>
  <button class="toggle-button" (click)="toggleTable('employeesExits')" [class.active]="isEmployeesExits">
    ุฃุฐููุงุช ุงูููุธููู
  </button>
  <button class="toggle-button" (click)="toggleTable('myMorningDelays')" [class.active]="showMyDelays">
    ุชุฃุฎูุฑู
  </button>
  <button class="toggle-button" (click)="toggleTable('employeesMorningDelays')"
    [class.active]="isEmployeesMorningDelays">
    ุชุฃุฎูุฑุงุช ุงูููุธููู
  </button>
</div>

<div *ngIf="isLoading" class="spinner">
  Loading...
</div>

<div *ngIf="!isLoading && errorMessage" class="error-message">
  {{ errorMessage }}
</div>

<!-- My Exits Table -->
<div *ngIf="showMyExits && !isLoading && !errorMessage">
  <h2>ุฃุฐููุงุชู</h2>
  <div class="table-container">
    <table class="authorization-table" dir="rtl">
      <thead>
        <tr>
          <th>ุงูุชุงุฑูุฎ</th>
          <th>ุฒูู ุงูุฎุฑูุฌ</th>
          <th>ููุช ุงูุนูุฏุฉ</th>
          <th>ููุน ุงูุฅุฐู</th>
          <th>ุญุงูุฉ ุงูุฅุฐู</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let exit of filteredMyExits.slice().reverse()">
          <td>{{ exit.day | date: 'MMM dd, yyyy' }}</td>
          <td>{{ exit.exitStartTime }}</td>
          <td>{{ exit.returnTime }}</td>
          <td>{{ exit.exitDescription }}</td>
          <td>
            <span *ngIf="exit.state === 'ููุจููุฉ'" class="status accepted">โ๏ธ ููุจููุฉ</span>
            <span *ngIf="exit.state === 'ูุฑููุถุฉ'" class="status rejected">โ ูุฑููุถุฉ</span>
            <span *ngIf="exit.state === 'ููุฏ ุงูุงูุชุธุงุฑ'" class="status pending">๐ ููุฏ ุงูุชูููุฐ</span>
          </td>
        </tr>
        <tr *ngIf="filteredMyExits.length === 0">
          <td colspan="5" class="empty-message">ูุง ุชูุฌุฏ ุฃุฐููุงุช ุฎุฑูุฌ ูุนุฑุถูุง.</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Employees' Exits Table -->
<div *ngIf="isEmployeesExits && !isLoading && !errorMessage">
  <h2>ุฃุฐููุงุช ุงูููุธููู</h2>
  <div class="table-container">
    <table class="authorization-table" dir="rtl">
      <thead>
        <tr>
          <th>ุงุณู ุงูููุธู</th>
          <th>ุงูุชุงุฑูุฎ</th>
          <th>ุฒูู ุงูุฎุฑูุฌ</th>
          <th>ููุช ุงูุนูุฏุฉ</th>
          <th>ููุน ุงูุฅุฐู</th>
          <th>ุญุงูุฉ ุงูุฅุฐู</th>
          <th>ุฅุฌุฑุงุก</th>
          </tr>
          </thead>
          <tbody>
          <!-- <tr *ngFor="let exit of filteredEmployeesExits.slice().reverse()" [ngClass]="{ 'new-request': exit.isNew }"> -->
          <tr *ngFor="let exit of filteredEmployeesExits.slice().reverse()" [ngClass]="{ 'highlight-pending': exit.isPending }">

              <td>{{ exit.name }}</td>
              <td>{{ exit.day | date: 'MMM dd, yyyy' }}</td>
              <td>{{ exit.exitStartTime }}</td>
              <td>{{ exit.returnTime }}</td>
              <td>{{ exit.exitDescription }}</td>
              <td>
                <span *ngIf="exit.state === 'ููุจููุฉ'" class="status accepted">โ๏ธ ููุจููุฉ</span>
                <span *ngIf="exit.state === 'ูุฑููุถุฉ'" class="status rejected">โ ูุฑููุถุฉ</span>
                <span *ngIf="exit.state === 'ููุฏ ุงูุงูุชุธุงุฑ'" class="status pending">๐ ููุฏ ุงูุชูููุฐ</span>
              </td>
              <td *ngIf="exit.state === 'ููุฏ ุงูุงูุชุธุงุฑ'">
                <button class="btn approve-btn" (click)="approveExit(exit.id)">ููุงููุฉ</button>
                <button class="btn reject-btn" (click)="rejectExit(exit.id)">ุฑูุถ</button>
              </td>
              <td *ngIf="exit.state !== 'ููุฏ ุงูุงูุชุธุงุฑ'">-</td>
            </tr>
            <tr *ngIf="filteredEmployeesExits.length === 0">
              <td colspan="7" class="empty-message">ูุง ุชูุฌุฏ ุฃุฐููุงุช ุฎุฑูุฌ ูุนุฑุถูุง.</td>
            </tr>
          </tbody>
          </table>
          </div>
          </div>
          
          <!-- My Morning Delays Table -->
          <div *ngIf="showMyDelays && !isLoading && !errorMessage">
            <h2>ุชุฃุฎูุฑู</h2>
            <div class="table-container">
              <table class="authorization-table" dir="rtl">
                <thead>
                  <tr>
                    <th>ุงูุชุงุฑูุฎ</th>
                    <th>ููุช ุงูุชุฃุฎูุฑ</th>
                    <th>ุงููุตู</th>
                    <th>ุญุงูุฉ ุงูุชุฃุฎูุฑ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let delay of filteredMyMorningDelays.slice().reverse()">
                    <td>{{ delay.day | date: 'MMM dd, yyyy' }}</td>
                    <td>{{ delay.time }}</td>
                    <td>{{ delay.description }}</td>
                    <td>
                      <span *ngIf="delay.state === 'ููุจููุฉ'" class="status accepted">โ๏ธ ููุจููุฉ</span>
                      <span *ngIf="delay.state === 'ูุฑููุถุฉ'" class="status rejected">โ ูุฑููุถุฉ</span>
                      <span *ngIf="delay.state === 'ููุฏ ุงูุงูุชุธุงุฑ'" class="status pending">๐ ููุฏ ุงูุชูููุฐ</span>
                    </td>
                  </tr>
                  <tr *ngIf="filteredMyMorningDelays.length === 0">
                    <td colspan="4" class="empty-message">ูุง ุชูุฌุฏ ุชุฃุฎูุฑุงุช ูุนุฑุถูุง.</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <!-- Employees' Morning Delays Table -->
          <div *ngIf="isEmployeesMorningDelays && !isLoading && !errorMessage">
            <h2>ุชุฃุฎูุฑุงุช ุงูููุธููู</h2>
            <div class="table-container">
              <table class="authorization-table" dir="rtl">
                <thead>
                  <tr>
                    <th>ุงุณู ุงูููุธู</th>
                    <th>ุงูุชุงุฑูุฎ</th>
                    <th>ููุช ุงูุชุฃุฎูุฑ</th>
                    <th>ุงููุตู</th>
                    <th>ุญุงูุฉ ุงูุชุฃุฎูุฑ</th>
                    <th>ุฅุฌุฑุงุก</th>
                  </tr>
                </thead>
                <tbody>
      <!-- <tr *ngFor="let delay of filteredEmployeesMorningDelays.slice().reverse()" [ngClass]="{ 'new-request': delay.isNew }"> -->
      <tr *ngFor="let delay of filteredEmployeesMorningDelays.slice().reverse()"
        [ngClass]="{ 'highlight-pending': delay.isPending }">

          <td>{{ delay.name }}</td>
          <td>{{ delay.day | date: 'MMM dd, yyyy' }}</td>
          <td>{{ delay.time }}</td>
          <td>{{ delay.description }}</td>
          <td>
            <span *ngIf="delay.state === 'ููุจููุฉ'" class="status accepted">โ๏ธ ููุจููุฉ</span>
            <span *ngIf="delay.state === 'ูุฑููุถุฉ'" class="status rejected">โ ูุฑููุถุฉ</span>
            <span *ngIf="delay.state === 'ููุฏ ุงูุงูุชุธุงุฑ'" class="status pending">๐ ููุฏ ุงูุชูููุฐ</span>
            </td>
          <td *ngIf="delay.state === 'ููุฏ ุงูุงูุชุธุงุฑ'">
            <button class="btn approve-btn" (click)="approveDelay(delay.id)">ููุงููุฉ</button>
            <button class="btn reject-btn" (click)="rejectDelay(delay.id)">ุฑูุถ</button>
          </td>
          <td *ngIf="delay.state !== 'ููุฏ ุงูุงูุชุธุงุฑ'">-</td>
          </tr>
          <tr *ngIf="filteredEmployeesMorningDelays.length === 0">
            <td colspan="6" class="empty-message">ูุง ุชูุฌุฏ ุชุฃุฎูุฑุงุช ูุนุฑุถูุง.</td>
        </tr>
        </tbody>
        </table>
  </div>
  </div>